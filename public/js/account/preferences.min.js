const saveNewEmail=async()=>{const email=document.getElementById("email").value,password=document.getElementById("password").value,json=await Api.post_async("/v1/update-email",{email:email,password:password}).catch((()=>appMessage("error","An unexpected error occurred. Please refresh the page and try again.")));appMessage(json.status,json.message)},changePassword=async()=>{const repeat_password=document.getElementById("repeat_password").value,new_password=document.getElementById("new_password").value,old_password=document.getElementById("old_password").value;if(new_password!=repeat_password)return void appMessage("error","Passwords do not match");const json=await Api.post_async("/v1/change-password",{old_password:old_password,new_password:new_password,repeat_password:repeat_password}).catch((()=>appMessage("error","An unexpected error occurred. Please refresh the page and try again.")));appMessage(json.status,json.message)};document.addEventListener("DOMContentLoaded",(async()=>{"/account/preferences"!=location.pathname&&history.pushState({},document.title,"/account/preferences"),sidebar(),livetime(),setInterval(livetime,1e3),document.querySelectorAll("select").forEach((el=>{new Choices(el,{searchEnabled:!0})}));for await(const el of document.querySelectorAll(".toggle-sidenav"))el.addEventListener("click",toggler,!1),el.addEventListener("touchstart",toggler,!!supportsPassive&&{passive:!0});for await(const el of document.querySelectorAll(".menu-opener"))el.addEventListener("click",toggler,!1),el.addEventListener("touchstart",toggler,!!supportsPassive&&{passive:!0});const emailChangeEl=document.getElementById("change-email-button");emailChangeEl.addEventListener("click",saveNewEmail,!1),emailChangeEl.addEventListener("touchstart",saveNewEmail,!!supportsPassive&&{passive:!0});const changePasswordEl=document.getElementById("change-password-button");changePasswordEl.addEventListener("click",changePassword,!1),changePasswordEl.addEventListener("touchstart",changePassword,!!supportsPassive&&{passive:!0})}),!1);