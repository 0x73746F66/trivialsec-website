const save_email=async()=>{const emailEl=document.getElementById("email");emailEl.classList.remove("error"),emailEl.classList.remove("success");const new_email=emailEl.value,json=await PublicApi.post({target:"/account/update-email",body:{new_email:new_email}});"success"==json.status&&emailEl.classList.add("success"),"error"==json.status&&(emailEl.classList.add("error"),alert(json.message))},regenerate_scratch=async()=>{console.log("regenerate_scratch")},setup_totp=async()=>{console.log("setup_totp")},change_name=async event=>{event.preventDefault(),inputHandle&&clearTimeout(inputHandle);const device_name=event.target.textContent,device_id=event.target.parent("tr").getAttribute("data-mfa-id"),json=await PublicApi.post({target:"/mfa/rename-device",body:{device_id:device_id,device_name:device_name}});"success"==json.status&&event.target.classList.add("success"),"error"==json.status&&(event.target.classList.add("error"),alert(json.message))};var inputHandle;const handle_input=async event=>{inputHandle&&clearTimeout(inputHandle),inputHandle=setTimeout(change_name.bind(null,event),2e3)};document.addEventListener("DOMContentLoaded",(async()=>{"/account/preferences"!=location.pathname&&history.pushState({},document.title,"/account/preferences"),sidebar(),livetime(),setInterval(livetime,1e3);const emailChangeEl=document.getElementById("email");emailChangeEl.addEventListener("change",save_email,!1),emailChangeEl.addEventListener("keypress",(async event=>"Enter"===event.key?save_email():void 0));const regenerateEl=document.getElementById("regenerate");regenerateEl&&(regenerateEl.addEventListener("click",regenerate_scratch,!1),regenerateEl.addEventListener("touchstart",regenerate_scratch,!!supportsPassive&&{passive:!0}));const setupEl=document.getElementById("setup_totp");setupEl&&(setupEl.addEventListener("click",setup_totp,!1),setupEl.addEventListener("touchstart",setup_totp,!!supportsPassive&&{passive:!0}));for(const el of document.querySelectorAll(".u2fkeyname"))el.addEventListener("input",handle_input,!1),el.addEventListener("keypress",(async event=>"Enter"===event.key?change_name(event):void 0))}),!1);